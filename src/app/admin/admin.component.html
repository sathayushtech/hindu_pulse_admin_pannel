


<!-- 

  <div class="container mt-5 mb-3 ">
    <div class="flex-container">
      <div class="flex-item">
        <h1>staging data</h1>
        <div *ngFor="let newsdata of medianews" class="card my-4 shadow-lg">
          <div class="row no-gutters">
            <div class="col-md-4 d-flex align-items-center" style="padding: 10px;">
              <div>
                <ng-container *ngIf="newsdata.image; else defaultImage">
                  <img [src]="newsdata.image" class="card-img" alt="{{ newsdata.headline }}" style="object-fit: cover; height: 30%; width: 30%;">
                </ng-container>
                <ng-template #defaultImage>
                  <img src="https://media.istockphoto.com/id/1369150014/vector/breaking-news-with-world-map-background-vector.jpg?s=612x612&w=0&k=20&c=9pR2-nDBhb7cOvvZU_VdgkMmPJXrBQ4rB1AkTXxRIKM=" class="card-img" alt="Default Image" style="object-fit: cover; height: 10%; width: 10%;">
                </ng-template>
              </div>
              <div class="col-md-8">
                <div class="card-body">
                  <div *ngIf="isEditingId === newsdata._id; else viewMode">
                    <div>
                      <label>Headline:</label>
                      <input [(ngModel)]="editedNewsItem.headline" />
                    </div>
                    <div>
                      <label>Summary:</label>
                      <textarea [(ngModel)]="editedNewsItem.summary"></textarea>
                    </div>
                    <div>
                      <label>Link:</label>
                      <input [(ngModel)]="editedNewsItem.link" />
                    </div>
                    <div>
                      <label>URL:</label>
                      <input [(ngModel)]="editedNewsItem.url" />
                    </div>
                    <button (click)="saveChanges()">Save</button>
                    <button (click)="cancelEdit()">Cancel</button>
                  </div>
                  <ng-template #viewMode>
                    <h5 class="card-title">Headline: {{ newsdata.headline }}</h5>
                    <p class="card-text"><strong>Summary:</strong> {{ newsdata.summary || 'No summary available' }}</p>
                    <p class="card-text"><strong>Link:</strong> <a [href]="newsdata.link" target="_blank">{{ newsdata.link }}</a></p>
                    <p class="card-text"><strong>URL:</strong> <a [href]="newsdata.url" target="_blank">{{ newsdata.url }}</a></p>
                    <div style="display: flex; gap: 10px;">
                        <button (click)="transfer(newsdata._id)">Move</button>
                        <button (click)="startEditing(newsdata)">Edit</button>
                        <button (click)="deleteNews(newsdata._id)">Delete</button>
                    </div>
                  </ng-template>
                </div>
              </div>
            </div>
          </div>
        </div>
        </div>

        <div class="flex-item">
          <h1>Production data</h1>
          <div class="col-md-8">
            <div *ngFor="let production of productiondata" class="card my-4 shadow-lg">
              <div class="row no-gutters">
                <div class="col-md-4 d-flex align-items-center" style="padding: 10px;">
                    <div>
                        <ng-container *ngIf="production.image; else defaultImage">
                            <img [src]="production.image" class="card-img" alt="{{ production.headline }}" style="object-fit: cover; height: 10%; width: 10%;">
                          </ng-container>
                          <ng-template #defaultImage>
                            <img src="https://media.istockphoto.com/id/1369150014/vector/breaking-news-with-world-map-background-vector.jpg?s=612x612&w=0&k=20&c=9pR2-nDBhb7cOvvZU_VdgkMmPJXrBQ4rB1AkTXxRIKM=" class="card-img" alt="Default Image" style="object-fit: cover; height: 10%; width: 10%;">
                          </ng-template>
                    </div>
                    <div class="col-md-8">
                        <div class="card-body">
                          <h5 class="card-title">headline:{{ production.headline }}</h5>
                          <p class="card-text"><strong>Summary:</strong> {{ production.summary || 'No summary available' }}</p>
                          <p class="card-text"><strong>Link:</strong> <a [href]="production.link" target="_blank">{{ production.link }}</a></p>
                          <p class="card-text"><strong>URL:</strong> <a [href]="production.url" target="_blank">{{ production.url }}</a></p>
                        </div>     
                        
                      </div>
                </div>
              
              </div>
            </div>
          </div>
        </div>
      
    </div>
  </div> 


 -->










<!-- grid design -->
<!-- 
<div class="container mt-5 mb-3">
  <div class="grid-container">
    <div class="grid-item">
      <h1>Staging Data</h1>
      <button (click)="moveSelected()">Move Selected</button>
      <button (click)="deleteSelected()">Delete Selected</button>
      <table class="table">
        <thead>
          <tr>
            <th><input type="checkbox" (change)="toggleSelectAll($event)" /></th>
            <th>Image</th>
            <th>Headline</th>
            <th>Summary</th>
            <th>Link</th>
            <th>Category</th>
            <th>Subcategory</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let newsdata of medianews"  [ngClass]="{ 'editing-mode': isEditingId === newsdata._id }">
            <td><input type="checkbox" [(ngModel)]="newsdata.selected" /></td>
            <td>
              <ng-container *ngIf="newsdata.image; else defaultImage">
                <img [src]="newsdata.image" alt="{{ newsdata.headline }}" style="object-fit: cover; height: 100px; width: 100px;">
              </ng-container>
              <ng-template #defaultImage>
                <img src="https://media.istockphoto.com/id/1369150014/vector/breaking-news-with-world-map-background-vector.jpg?s=612x612&w=0&k=20&c=9pR2-nDBhb7cOvvZU_VdgkMmPJXrBQ4rB1AkTXxRIKM=" alt="Default Image" style="object-fit: cover; height: 100px; width: 100px;">
              </ng-template>
            </td>
            <td>
              <div *ngIf="isEditingId === newsdata._id; else viewModeHeadline">
                <textarea [(ngModel)]="editedNewsItem.headline"></textarea>
              </div>
              <ng-template #viewModeHeadline>
                {{ newsdata.headline || 'No heading available' }}
              </ng-template>
            </td>
            <td>
              <div *ngIf="isEditingId === newsdata._id; else viewModeSummary">
                <textarea [(ngModel)]="editedNewsItem.summary"></textarea>
              </div>
              <ng-template #viewModeSummary>
                {{ newsdata.summary || 'No summary available' }}
              </ng-template>
            </td>
           
            <td><a [href]="newsdata.link" target="_blank">{{ newsdata.link }}</a></td>

            <td>
              <div *ngIf="isEditingId === newsdata._id; else viewModeCategory">
                <select [(ngModel)]="editedNewsItem.category" (change)="onCategoryChange($event)">
                  <option *ngFor="let category of categories" [value]="category._id">
                    {{ category.name }}
                  </option>
                </select>
              </div>
              <ng-template #viewModeCategory>
                {{ newsdata.category?.name || 'No category' }}
              </ng-template>
            </td>
            <td>
              <div *ngIf="isEditingId === newsdata._id; else viewModeSubCategory">
                <select [(ngModel)]="editedNewsItem.subcategory">
                  <option *ngFor="let subCategory of filteredSubCategories" [value]="subCategory._id">
                    {{ subCategory.name }}
                  </option>
                </select>
              </div>
              <ng-template #viewModeSubCategory>
                {{ newsdata.subcategory?.name || 'No subcategory' }}
              </ng-template>
            </td>
            
            
            <td>
              <div *ngIf="isEditingId === newsdata._id; else actionButtons">
                <button (click)="saveChanges()">Save</button>
                <button (click)="cancelEdit()">Cancel</button>
              </div>
              <ng-template #actionButtons >
                <button (click)="transfer(newsdata._id)">Move</button>
                <button (click)="startEditing(newsdata)">Edit</button>
                <button (click)="deleteNews(newsdata._id)">Delete</button>
              </ng-template>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="grid-item">
      <h1>Production Data</h1>
      <table class="table">
        <thead>
          <tr>
            <th>Image</th>
            <th>Headline</th>
            <th>Summary</th>
            <th>Link</th>
            <th>Category</th>
            <th>Subcategory</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let production of productiondata">
            <td>
              <ng-container *ngIf="production.image; else defaultImage">
                <img [src]="production.image" alt="{{ production.headline }}" style="object-fit: cover; height: 100px; width: 100px;">
              </ng-container>
              <ng-template #defaultImage>
                <img src="https://media.istockphoto.com/id/1369150014/vector/breaking-news-with-world-map-background-vector.jpg?s=612x612&w=0&k=20&c=9pR2-nDBhb7cOvvZU_VdgkMmPJXrBQ4rB1AkTXxRIKM=" alt="Default Image" style="object-fit: cover; height: 100px; width: 100px;">
              </ng-template>
            </td>
            <td>{{ production.headline }}</td>
            <td>{{ production.summary || 'No summary available' }}</td>
            <td><a [href]="production.link" target="_blank">{{ production.link }}</a></td>
            <td>
              <p>{{ getCategoryName(production.category_id) }}</p>
            </td>
            <td>
              <p>{{ getSubCategoryName(production.news_sub_category_id) }}</p>
            </td>
            <td>
              <button (click)="deleteProduction(production._id)">Delete</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>   -->

<!-- it is working  -->

<!-- <div class="container mt-5 mb-3">
  <div class="grid-container">
    <div class="grid-item">
      <h1>Staging Data</h1>
      <button (click)="moveSelected()">Move Selected</button>
      <button (click)="deleteSelected()">Delete Selected</button>
      <table class="table">
        <thead>
          <tr>
            <th><input type="checkbox" (change)="toggleSelectAll($event)" /></th>
            <th>Image</th>
            <th>Headline</th>
            <th>Description</th>
            <th>url</th>
            <th>Category</th>
            <th>Subcategory</th>
            <th>Status</th>
            <th>Location</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let newsdata of medianews">
            <td><input type="checkbox" [(ngModel)]="newsdata.selected" /></td>
            <td>
              <div *ngIf="isEditingId === newsdata._id">
                <nz-upload
                  nzListType="picture-card"
                  [(nzFileList)]="bannerFileList"
                  [nzShowButton]="bannerFileList.length < 1"
                  (nzChange)="handleBannerFileChange($event)"
                  [nzAccept]="'image/*'"
                >
                  <div style="width: 100px; height: 100px; display: flex; align-items: center; justify-content: center; border: 1px solid #d9d9d9; border-radius: 4px; cursor: pointer;">
                    <i nz-icon nzType="plus" style="font-size: 24px;"></i>
                    <span style="margin-left: 8px;">Upload image</span>
                  </div>
                </nz-upload>
              </div>
              <ng-container *ngIf="isEditingId !== newsdata._id">
                <img *ngIf="newsdata.image_location && newsdata.image_location !== 'defaultimage'" 
                    [src]="'data:image/jpeg;base64,' + newsdata.image_location" 
                    class="card-img-top" 
                    alt="{{ newsdata.headline }}" 
                    style="height: 100px; width: 100px;">
                <img *ngIf="!newsdata.image_location || newsdata.image_location === 'defaultimage'" 
                    src="../../assets/defaultimage.jpg" 
                    class="card-img-top" 
                    alt="Default image" 
                    style="height: 100px; width: 100px;">
              </ng-container>
            </td>
            <td>
              <div *ngIf="isEditingId === newsdata._id; else viewModeHeadline">
                <textarea [(ngModel)]="editedNewsItem.headline"></textarea>
              </div>
              <ng-template #viewModeHeadline>
                {{ newsdata.headline || 'No heading available' }}
              </ng-template>
            </td>
            <td>
              <div *ngIf="isEditingId === newsdata._id; else viewModeSummary">
                <textarea [(ngModel)]="editedNewsItem.desc"></textarea>
              </div>
              <ng-template #viewModeSummary>
                {{ newsdata.desc || 'No summary available' }}
              </ng-template>
            </td>
            <td><a [href]="newsdata.url" target="_blank">{{ newsdata.url }}</a></td>
            <td>
              <div *ngIf="isEditingId === newsdata._id; else viewModeCategory">
                <select [(ngModel)]="editedNewsItem.category_id" (change)="onCategoryChange($event)">
                  <option *ngFor="let category of categories" [value]="category._id">
                    {{ category.name }}
                  </option>
                </select>
              </div>
              <ng-template #viewModeCategory>
                {{ newsdata.category?.name || 'No category' }}
              </ng-template>
            </td>
            <td>
              <div *ngIf="isEditingId === newsdata._id; else viewModeSubCategory">
                <select [(ngModel)]="editedNewsItem.news_sub_category_id">
                  <option *ngFor="let subCategory of filteredSubCategories" [value]="subCategory._id">
                    {{ subCategory.name }}
                  </option>
                </select>
              </div>
              <ng-template #viewModeSubCategory>
                {{ newsdata.subcategory?.name || 'No subcategory' }}
              </ng-template>
            </td>
         
            <td>
              <div *ngIf="isEditingId === newsdata._id; else viewModeStatus">
                <select [(ngModel)]="editedNewsItem.status">
                  <option value="pending">Pending</option>
                  <option value="in-progress">In Progress</option>
                  <option value="SUCCESS">Success</option>
                  <option value="failed">Failed</option>
                </select>
              </div>
              <ng-template #viewModeStatus>
                {{ newsdata.status || 'No status' }}
              </ng-template>
            </td>
           
            <td>
              <div *ngIf="isEditingId === newsdata._id; else viewModeLocation">
                <input type="text" [(ngModel)]="editedNewsItem.location" />
              </div>
              <ng-template #viewModeLocation>
                {{ newsdata.location || 'No location' }}
              </ng-template>
            </td>
            <td>
              <div *ngIf="isEditingId === newsdata._id; else actionButtons">
                <button (click)="saveChanges()">Save</button>
                <button (click)="cancelEdit()">Cancel</button>
              </div>
              <ng-template #actionButtons>
                <button (click)="transfer(newsdata._id)">Move</button>
                <button (click)="startEditing(newsdata)">Edit</button>
                <button (click)="deleteNews(newsdata._id)">Delete</button>
              </ng-template>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="grid-item">
      <h1>Production Data</h1>
      <table class="table">
        <thead>
          <tr>
            <th>Image</th>
            <th>Headline</th>
            <th>Description</th>
            <th>url</th>
            <th>Category</th>
            <th>Subcategory</th>
            <th>Status</th>
            <th>Location</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let production of productiondata">
           
            <td>
              <img [src]="production.image_location ? 'data:image/jpeg;base64,' + production.image_location : 'assets/modi.jpg'" class="card-img-top" alt="{{ production.headline }}" style="height: 100px; width: 100px;">
            </td>
            <td>{{ production.headline }}</td>
            <td>{{ production.desc || 'No summary available' }}</td>
            <td><a [href]="production.url" target="_blank">{{ production.url }}</a></td>
            <td>
              <p>{{ getCategoryName(production.category_id) }}</p>
            </td>
            <td>
              <p>{{ getSubCategoryName(production.news_sub_category_id) }}</p>
            </td>
            <td>{{ production.status }}</td>
            <td>{{ production.location }}</td>
            <td>
              <button (click)="deleteProduction(production._id)">Delete</button>

              <button (click)="undoFromProductiondb(production._id)">undo</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div> -->


<div class="container mt-5 mb-3">
  <div class="grid-container">
    <div class="grid-item">
      <h1>Staging Data</h1>
      <button style="margin-right: 15px;" (click)="moveSelected()">Move Selected</button>
      <button style="margin-right: 15px;" (click)="deleteSelected()">Delete Selected</button>
     
        <button (click)="loadPage(currentPage - 1)" [disabled]="currentPage <= 1"><span class="arrow prev" >&#9664;</span> </button>
        <span>{{ currentPage }}</span>
        <button (click)="loadPage(currentPage + 1)"><span class="arrow next">&#9654;</span></button>

      <table class="table">
        <thead>
          <tr>
            <th><input type="checkbox" (change)="toggleSelectAll($event)" /></th>
            <th>Image</th>
            <th>Headline</th>
            <th>Description</th>
            <th>short_Desc</th>
            <th>URL</th>
            <th>Category</th>
            <th>Subcategory</th>
            <th>Status</th>
            <th>Location</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let newsdata of medianews" [ngClass]="{ 'visited': visitedNews.includes(newsdata._id) }" >
            <td><input type="checkbox" [(ngModel)]="newsdata.selected" /></td>
            <td>
              <div *ngIf="isEditingId === newsdata._id">
                <nz-upload
                  nzListType="picture-card"
                  [(nzFileList)]="bannerFileList"
                  [nzShowButton]="bannerFileList.length < 1"
                  (nzChange)="handleBannerFileChange($event)"
                  [nzAccept]="'image/*'"
                >
                  <div style="width: 100px; height: 100px; display: flex; align-items: center; justify-content: center; border: 1px solid #d9d9d9; border-radius: 4px; cursor: pointer;">
                    <i nz-icon nzType="plus" style="font-size: 24px;"></i>
                    <span style="margin-left: 8px;">Upload image</span>
                  </div>
                </nz-upload>
              </div>
              <ng-container *ngIf="isEditingId !== newsdata._id">
                <img *ngIf="newsdata.image_location && newsdata.image_location !== 'defaultimage'" 
                    [src]="'data:image/jpeg;base64,' + newsdata.image_location" 
                    class="card-img-top" 
                    alt="{{ newsdata.headline }}" 
                    style="height: 100px; width: 100px;">
                <img *ngIf="!newsdata.image_location || newsdata.image_location === 'defaultimage'" 
                    src="../../assets/defaultimage.jpg" 
                    class="card-img-top" 
                    alt="Default image" 
                    style="height: 100px; width: 100px;">
              </ng-container>
            </td>
            <td>
              <div *ngIf="isEditingId === newsdata._id; else viewModeHeadline">
                <textarea [(ngModel)]="editedNewsItem.headline"></textarea>
              </div>
              <ng-template #viewModeHeadline>
                {{ newsdata.headline || 'No heading available' }}
              </ng-template>
            </td>
            <td>
              <div *ngIf="isEditingId === newsdata._id; else viewModedesc">
                <textarea [(ngModel)]="editedNewsItem.desc"></textarea>
              </div>
              <ng-template #viewModedesc>
                {{ newsdata.desc || 'No desc available' }}
              </ng-template>
            </td>
<!-- ################### -->
            <td>
              <div *ngIf="isEditingId === newsdata._id; else viewModeshortdescription">
                <textarea [(ngModel)]="editedNewsItem.short_description"></textarea>
              </div>
              <ng-template #viewModeshortdescription>
                {{ newsdata.short_description||'No short desc available'}}
              </ng-template>
            </td>

            <td><a [href]="newsdata.url" target="_blank">{{ newsdata.url }}</a></td>
            <!-- <td>
              <div *ngIf="isEditingId === newsdata._id; else viewModeCategory">
                <select [(ngModel)]="editedNewsItem.category_id" (change)="onCategoryChange($event)">
                  <option *ngFor="let category of categories" [value]="category._id">
                    {{ category.name }}
                  </option>
                </select>
              </div>
              <ng-template #viewModeCategory>
                {{ newsdata.category?.name || 'No category' }}
              </ng-template>
            </td>
            <td>
              <div *ngIf="isEditingId === newsdata._id; else viewModeSubCategory">
                <select [(ngModel)]="editedNewsItem.news_sub_category_id">
                  <option *ngFor="let subCategory of filteredSubCategories" [value]="subCategory._id">
                    {{ subCategory.name }}
                  </option>
                </select>
              </div>
              <ng-template #viewModeSubCategory>
                {{ newsdata.subcategory?.name || 'No subcategory' }}
              </ng-template>
            </td> -->


            <td>
              <div *ngIf="isEditingId === newsdata._id; else viewModeCategory">
                <select [(ngModel)]="editedNewsItem.category_id" (change)="onCategoryChange($event)">
                  <option *ngFor="let category of categories" [value]="category._id">
                    {{ category.name }}
                  </option>
                </select>
              </div>
              <ng-template #viewModeCategory>
                {{ getCategoryName(newsdata.category_id) }}
              </ng-template>
            </td>
            <td>
              <div *ngIf="isEditingId === newsdata._id; else viewModeSubCategory">
                <select [(ngModel)]="editedNewsItem.news_sub_category_id">
                  <option *ngFor="let subcategory of filteredSubCategories" [value]="subcategory._id">
                    {{ subcategory.name }}
                  </option>
                </select>
              </div>
              <ng-template #viewModeSubCategory>
                {{ getSubCategoryName(newsdata.news_sub_category_id) }}
              </ng-template>
            </td>
            
            <td>
              <div *ngIf="isEditingId === newsdata._id; else viewModeStatus">
                <select [(ngModel)]="editedNewsItem.status">
                  <option value="pending">Pending</option>
                  <option value="in-progress">In Progress</option>
                  <option value="SUCCESS">Success</option>
                  <option value="failed">Failed</option>
                </select>
              </div>
              <ng-template #viewModeStatus>
                {{ newsdata.status || 'No status' }}
              </ng-template>
            </td>
            <td>
              <div *ngIf="isEditingId === newsdata._id; else viewModeLocation">
                <input type="text" [(ngModel)]="editedNewsItem.location" />
              </div>
              <ng-template #viewModeLocation>
                {{ newsdata.location || 'No location' }}
              </ng-template>
            </td>
            <td>
              <div *ngIf="isEditingId === newsdata._id; else actionButtons">
                <button (click)="saveChanges()">Save</button>
                <button (click)="cancelEdit()">Cancel</button>
              </div>
              <ng-template #actionButtons>
                <button (click)="transfer(newsdata._id)">Move</button>
                <button (click)="startEditing(newsdata)">Edit</button>
                <button (click)="deleteNews(newsdata._id)">Delete</button>
              </ng-template>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    

    <div class="grid-item">
      <h1>Production Data</h1>
      <button (click)="loadProductionPage(currentProductionPage - 1)" [disabled]="currentProductionPage <= 1"><span class="arrow prev" >&#9664;</span></button>
      <span>{{ currentProductionPage }}</span>
      
      <button (click)="loadProductionPage(currentProductionPage + 1)"><span class="arrow next">&#9654;</span></button>
      
      <table class="table">
        <thead>
          <tr>
            <th>Image</th>
            <th>Headline</th>
            <th>Description</th>
            <th>short_desc</th>
            <th>URL</th>
            <th>Category</th>
            <th>Subcategory</th>
            <th>Status</th>
            <th>Location</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let production of productiondata">
            <td>
              <img [src]="production.image_location ? 'data:image/jpeg;base64,' + production.image_location : 'assets/modi.jpg'" class="card-img-top" alt="{{ production.headline }}" style="height: 100px; width: 100px;">
            </td>
            <td>{{ production.headline }}</td>
            <td>{{ production.desc || 'No desc available' }}</td>
            <td>{{production.short_description}}</td>
            <td><a [href]="production.url" target="_blank">{{ production.url }}</a></td>
            <td>{{ production.category_id?.name || 'No category' }}</td>
            <td>{{ production.news_sub_category_id?.name || 'No subcategory' }}</td>
            <td>{{ production.status }}</td>

            <td>{{ production.location }}</td>
            <td>
              <button (click)="deleteProduction(production._id)" >Delete</button>
              <button (click)="undoFromProductiondb(production._id)">Undo</button>
            
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>


